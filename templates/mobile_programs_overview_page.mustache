{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    @template block_myprograms/mobile_programs_overview_view

    The main page to view the a list of all of the current users programs

    Classes required for JS:
    * programs are required

    Data attibutes required for JS:
    * All data attributes are required

    Context variables required for this template:
    * All data attributes are required

    Example context (json):
    {
        "programs": [{
            "id":"1",
            "contextid":"1",
            "fullname":"Jamie Test",
            "idnumber":"1234",
            "description":"<p dir="\&quot;ltr\&quot;" style="\&quot;text-align:left;\&quot;">This is a description&lt;\/p&gt;",
            "descriptionformat":"1",
            "timeallocationstartdate":"28\/07\/22, 18:13",
            "timeallocationenddate":"28\/08\/22, 18:13",
            "duedate":"1\/10\/22, 17:01",
            "status":{"color":"success","text":"Completed"},
            "image":"",
            "progress":100,
            "tags":[{
                "id":5,"displayname":"test"
            }],
        }],
        "filteredprograms": [
            ...same layout as programs
        ]
    }
}}
{{=<% %>=}}

<ion-item-divider sticky="true">
    <ion-label>
        <h2>{{ 'plugin.block_myprograms.pluginname' | translate }}</h2>
    </ion-label>
    <div slot="end" class="flex-row">
    </div>
</ion-item-divider>
<%^hasprograms%>
    <core-format-text [text]="'plugin.block_myprograms.noprograms' | translate" ></core-format-text>
<%/hasprograms%>
<%#hasprograms%>
    <ion-row class="ion-justify-content-between ion-align-items-center block-myprograms-filter">
        <ion-col size="auto" class="md hydrated">
            <core-combobox [label]="'plugin.block_myprograms.filterprograms' | translate" selection="allactive"
                (ionChange)="filterOptionsChanged($event.target)">
                <ion-select-option class="ion-text-wrap" value="all">
                    {{ 'plugin.block_myprograms.programstatusall' | translate }}
                </ion-select-option>
                <ion-select-option class="ion-text-wrap core-select-option-border-bottom" value="allactive">
                    {{ 'plugin.block_myprograms.programstatusallactive' | translate }}
                </ion-select-option>
                <ion-select-option class="ion-text-wrap" value="open">
                    {{ 'plugin.block_myprograms.programstatusopen' | translate }}
                </ion-select-option>
                <ion-select-option class="ion-text-wrap" value="completed">
                    {{ 'plugin.block_myprograms.programstatuscompleted' | translate }}
                </ion-select-option>
                <ion-select-option class="ion-text-wrap" value="overdue">
                    {{ 'plugin.block_myprograms.programstatusoverdue' | translate }}
                </ion-select-option>
                <ion-select-option class="ion-text-wrap" value="failed">
                    {{ 'plugin.block_myprograms.programstatusfailed' | translate }}
                </ion-select-option>
            </core-combobox>
        </ion-col>
        <ion-col class="md hydrated">
            <!-- Filter programs. -->
            <ion-searchbar [(ngModel)]="textFilter" (ionInput)="filterTextChanged($event.target)"
                (ionCancel)="filterTextChanged($event.target)" [placeholder]="'plugin.block_myprograms.filterprograms' | translate">
            </ion-searchbar>
        </ion-col>
    </ion-row>
    <div class="safe-area-padding block-myprograms-results">
        <ion-grid class="ion-no-padding core-no-grid list-item-limited-width md hydrated">
            <ion-row class="ion-no-padding">
                <ion-col *ngFor="let program of CONTENT_OTHERDATA.filteredprograms" class="ion-no-padding" size="12" size-sm="6" size-md="6" size-lg="4" size-xl="3">
                    <ion-card class="md hydrated">
                        <ion-item button core-site-plugins-new-content class="ion-text-wrap" detail="false" [attr.aria-label]="program.fullname"
                            component="block_myprograms" method="mobile_program_view" [args]="{pid: program.id}">
                            <ng-container>
                                <ion-icon *ngIf="!program.image" name="fas-cubes" slot="start" aria-hidden="true">
                                </ion-icon>
                                <ion-avatar *ngIf="program.image" slot="start">
                                    <img [src]="program.image" core-external-content alt="" />
                                </ion-avatar>
                            </ng-container>
                            <ion-label>
                                <p class="item-heading"><core-format-text [text]="program.fullname"></core-format-text></p>
                                <ion-chip [color]="program.status.color" *ngIf="program.status"
                                    class="ion-text-nowrap">
                                    <span class="sr-only">{{program.status.text}}</span>
                                    <ion-label>
                                        <core-format-text [text]="program.status.text" [contextInstanceId]="program.contextid">
                                        </core-format-text>
                                    </ion-label>
                                </ion-chip>
                                <div>
                                    <span><b>{{ 'plugin.block_myprograms.allocationstart' | translate }} </b></span>
                                    <core-format-text [text]="program.timeallocated"></core-format-text>
                                </div>
                                <div *ngIf="program.timeend != null">
                                    <span><b>{{ 'plugin.block_myprograms.allocationend' | translate }} </b></span>
                                    <core-format-text [text]="program.timeend"></core-format-text>
                                </div>
                                <div *ngIf="program.duedate != null">
                                    <span><b>{{ 'plugin.block_myprograms.programdue' | translate }} </b></span>
                                    <core-format-text [text]="program.duedate"></core-format-text>
                                </div>
                                <div>
                                    <core-progress-bar [progress]="program.progress" a11yText="plugin.block_myprograms.programprogress"></core-progress-bar>
                                </div>
                            </ion-label>
                        </ion-item>
                    </ion-card>
                </ion-col>
            </ion-row>
        </ion-grid>
        <core-empty-box *ngIf="CONTENT_OTHERDATA.filteredprograms.length == 0" image="assets/img/icons/courses.svg">
            <p class="item-heading">
                {{'plugin.block_myprograms.noresult' | translate}}
            </p>
            <ng-container>
                <p class="subdued">
                    {{'plugin.block_myprograms.noresultdescription' | translate}}
                </p>
            </ng-container>
        </core-empty-box>
    </div>
<%/hasprograms%>


